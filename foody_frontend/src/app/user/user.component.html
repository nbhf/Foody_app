<div class="container mt-5">
    <div class="card shadow-lg p-4 position-relative">
        <!-- Options menu (â‹®) -->
        <div class="position-absolute top-0 end-0 m-3">
            <div class="dropdown">
                <button class="btn btn-light rounded-circle p-2 border" data-bs-toggle="dropdown">
                    <i class="bi bi-three-dots-vertical fs-4"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-end shadow">
                    <li><a class="dropdown-item" (click)="editMode = true"><i class="bi bi-pencil me-2"></i> Edit Profile</a></li>
                    <li><a class="dropdown-item" (click)="openChangePasswordModal()"><i class="bi bi-key me-2"></i> Change Password</a></li>
                    <li><hr class="dropdown-divider"></li>  <!-- Separation line -->
                    <li><a class="dropdown-item text-danger" (click)="confirmDelete()"><i class="bi bi-trash me-2"></i> Delete Account</a></li>
                </ul>
            </div>
        </div>

        <div class="text-center">
            <!-- Avatar -->
            <img [src]="user.imgUrl || 'assets/default-avatar.webp'" alt="Avatar" class="rounded-circle border" width="120" height="120">
            <h3 class="mt-3">{{ user.username }}</h3>
            <p class="text-muted">{{ user.email }}</p>
        </div>

        <!-- Edit Profile Form -->
        <div *ngIf="editMode" class="mt-4">
            <h5>Edit Profile</h5>
            <div class="form-group">
                <label>Username</label>
                <input type="text" [(ngModel)]="user.username" class="form-control">
            </div>
            <div class="form-group mt-2">
                <label>Email</label>
                <input type="email" [(ngModel)]="user.email" class="form-control">
            </div>
            <div class="text-center mt-3">
                <button class="btn btn-success" (click)="updateProfile()">Save</button>
                <button class="btn btn-secondary ms-2" (click)="editMode = false">Cancel</button>
            </div>
        </div>
    </div>
</div>

<!-- Change Password Modal -->
<div class="modal fade" id="changePasswordModal" tabindex="-1" aria-labelledby="changePasswordModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="changePasswordModalLabel">Change Password</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>New Password</label>
                    <input type="password" [(ngModel)]="newPassword" class="form-control">
                </div>
                <div class="form-group mt-2">
                    <label>Confirm Password</label>
                    <input type="password" [(ngModel)]="confirmPassword" class="form-control">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" (click)="changePassword()">Save</button>
            </div>
        </div>
    </div>
</div>
